# Модуль Timesheet (Табель рабочего времени)

**Дата актуализации:** 05 октября 2025 года (обновлено: добавлена логика отображения активных сотрудников и уволенных с часами)

---

## Важное замечание о структуре данных

> **Внимание:**
> Модуль "Табель" не имеет собственной таблицы в базе данных.
> Все данные для расчёта табеля агрегируются на лету из таблиц других модулей:
> - `work_hours` (модуль "Работы") — основная таблица с часами сотрудников
> - `works` (модуль "Работы") — информация о сменах и датах
> - `employees` (модуль "Сотрудники") — справочник сотрудников
> - `objects` (модуль "Объекты") — справочник объектов
>
> Таблица `work_hours` принадлежит модулю "Работы" и используется здесь только для аналитики и построения отчёта.
>
> **Логика отображения сотрудников:**
> - В табеле отображаются **все активные сотрудники** (статус != 'fired'), даже если у них нет часов в выбранном периоде
> - **Уволенные сотрудники** (статус = 'fired') отображаются **только если у них есть часы** в выбранном периоде
> - Это обеспечивает полный контроль над рабочим временем всех активных сотрудников и учёт часов уволенных до момента увольнения

---

## Детальное описание модуля

Модуль **Timesheet** отвечает за учёт, отображение и анализ рабочих часов сотрудников по объектам и сменам. Позволяет фильтровать, группировать и агрегировать данные по различным срезам (сотрудник, объект, дата, должность). Интегрируется с модулями сотрудников, объектов и смен, реализован по принципам Clean Architecture с разделением на data/domain/presentation, DI через Riverpod, строгой типизацией и поддержкой тестируемости.

**Важно:** 
- В табеле отображаются часы **только из закрытых смен** (`status = 'closed'`). Это обеспечивает корректность данных и предотвращает учёт часов из незавершённых или черновиков смен.
- В табеле отображаются **все активные сотрудники** (статус != 'fired'), даже если у них нет часов в выбранном периоде.
- **Уволенные сотрудники** показываются **только если у них есть часы** в выбранном месяце.

**Ключевые функции:**
- Поиск по ФИО сотрудников с анимированным полем в AppBar (аналогично модулю материалов)
- Просмотр отработанных часов в календарном представлении
- Фильтрация по году, месяцу, объектам (мультивыбор) и должностям (мультивыбор)
- **Экспорт табеля в PDF** с возможностью сохранения файла
- Адаптивный UI для всех платформ (десктоп, планшет, мобильный)
- Интеграция с Supabase (таблицы work_hours, works, employees, objects)
- Поддержка RLS и политик безопасности
- Обогащение данных (enrichment) именами сотрудников и объектов

**Архитектурные особенности:**
- Clean Architecture: разделение на data/domain/presentation/features
- DI через Riverpod
- Freezed/JsonSerializable для моделей
- Иммутабельные модели, строгая типизация
- Вся работа с БД — через Supabase DataSource
- Легко расширяется (экспорт, inline-редактирование, печать)

---

## Используемые таблицы и зависимости

Модуль **Timesheet** агрегирует данные из следующих таблиц (и модулей):
- **work_hours** — хранит отработанные часы (модуль "Работы")
- **works** — информация о сменах, датах, объектах (модуль "Работы")
- **employees** — справочник сотрудников (модуль "Сотрудники")
- **objects** — справочник объектов (модуль "Объекты")

> Модуль не владеет ни одной из этих таблиц, а только использует их для построения аналитики и отчётов.

---

## Структура и файлы модуля

### Presentation/UI

- `lib/features/timesheet/presentation/screens/timesheet_screen.dart` — Оптимизированный основной экран табеля: использование цветов темы, упрощённое отображение ошибок, адаптивный loader.
- `lib/features/timesheet/presentation/widgets/timesheet_filter_widget.dart` — Объединённый файл: поиск по ФИО с анимированным полем, кнопка фильтра и всплывающая панель фильтров (множественный выбор объектов и должностей с применением по кнопке).
- `lib/features/timesheet/presentation/widgets/timesheet_calendar_view.dart` — Оптимизированное календарное представление табеля: таблица с днями, сотрудниками и часами, адаптивный дизайн, детали записей по клику. **Обновлено 05.10.2025:** теперь `ConsumerStatefulWidget` с загрузкой всех активных сотрудников и уволенных с часами.
- `lib/features/timesheet/presentation/widgets/timesheet_pdf_action.dart` — Кнопка экспорта табеля в PDF с автоматическим сохранением файла.
- `lib/features/timesheet/presentation/providers/timesheet_provider.dart` — StateNotifier и состояние табеля: хранит записи, фильтры, ошибки, загрузку.
- `lib/features/timesheet/presentation/providers/timesheet_filters_providers.dart` — Провайдеры доступных объектов и должностей для панели фильтров.
- `lib/features/timesheet/presentation/providers/repositories_providers.dart` — Провайдеры зависимостей: dataSource, repository, интеграция с core DI.

### Domain (бизнес-логика)

- `lib/features/timesheet/domain/entities/timesheet_entry.dart` — Доменная сущность записи табеля (Freezed), отражает структуру work_hours + enrich.
- `lib/features/timesheet/domain/repositories/timesheet_repository.dart` — Абстракция репозитория для DI и тестирования.

### Data (работа с БД/Supabase)

- `lib/features/timesheet/data/datasources/timesheet_data_source.dart` — Абстракция источника данных для табеля.
- `lib/features/timesheet/data/datasources/timesheet_data_source_impl.dart` — Реализация источника данных: Supabase, join с works для получения дат и object_id, фильтрация.
- `lib/features/timesheet/data/repositories/timesheet_repository_impl.dart` — Имплементация репозитория: обогащение данными сотрудников/объектов, агрегация, группировка.
- `lib/features/timesheet/data/models/timesheet_entry_model.dart` — Data-модель записи табеля для сериализации/десериализации (Freezed + JsonSerializable).
- `lib/features/timesheet/data/models/timesheet_entry_model.g.dart` — Автогенерируемый файл сериализации (json_serializable).
- `lib/features/timesheet/data/models/timesheet_entry_model.freezed.dart` — Автогенерируемый файл иммутабельности (Freezed).

### Дополнительные файлы

- `lib/features/timesheet/presentation/services/timesheet_pdf_service.dart` — Сервис экспорта табеля в PDF (генерация документа и сохранение файла). **Обновлено 05.10.2025:** принимает `EmployeeRepository` для загрузки всех активных сотрудников и уволенных с часами.
- `lib/features/timesheet/domain/entities/timesheet_entry.g.dart` — Автогенерируемый файл сериализации для доменной сущности.
- `lib/features/timesheet/domain/entities/timesheet_entry.freezed.dart` — Автогенерируемый файл иммутабельности для доменной сущности.

---

## Дерево структуры модуля

```
lib/
└── features/
    └── timesheet/
        ├── data/
        │   ├── datasources/
        │   │   ├── timesheet_data_source.dart
        │   │   └── timesheet_data_source_impl.dart
        │   ├── models/
        │   │   ├── timesheet_entry_model.dart
        │   │   ├── timesheet_entry_model.g.dart
        │   │   └── timesheet_entry_model.freezed.dart
        │   └── repositories/
        │       └── timesheet_repository_impl.dart
        ├── domain/
        │   ├── entities/
        │   │   ├── timesheet_entry.dart
        │   │   ├── timesheet_entry.g.dart
        │   │   └── timesheet_entry.freezed.dart
        │   └── repositories/
        │       └── timesheet_repository.dart
        └── presentation/
            ├── screens/
            │   └── timesheet_screen.dart
            ├── widgets/
            │   ├── timesheet_filter_widget.dart
            │   ├── timesheet_pdf_action.dart
            │   └── timesheet_calendar_view.dart
            ├── services/
            │   └── timesheet_pdf_service.dart
            └── providers/
                ├── timesheet_provider.dart
                ├── timesheet_filters_providers.dart
                └── repositories_providers.dart
```

---

## База данных и RLS-политики

### Основные таблицы

Модуль использует следующие таблицы из базы данных:

#### Таблица `work_hours` (принадлежит модулю "Работы")

**Структура:**
| Колонка      | Тип         | Описание                                                        |
|--------------|-------------|-----------------------------------------------------------------|
| id           | UUID, PK    | Уникальный идентификатор записи                                 |
| work_id      | UUID, FK    | Ссылка на смену (works.id)                                      |
| employee_id  | UUID, FK    | Ссылка на сотрудника (employees.id)                             |
| hours        | NUMERIC     | Количество отработанных часов                                   |
| comment      | TEXT        | Комментарий (опционально)                                       |
| created_at   | TIMESTAMP   | Дата и время создания записи (UTC)                              |
| updated_at   | TIMESTAMP   | Дата и время последнего обновления записи (UTC)                 |

**Количество записей:** 61

#### Таблица `works` (принадлежит модулю "Работы")

**Структура:**
| Колонка              | Тип         | Описание                                                        |
|----------------------|-------------|-----------------------------------------------------------------|
| id                   | UUID, PK    | Уникальный идентификатор смены                                  |
| date                 | DATE        | Дата смены                                                      |
| object_id            | UUID, FK    | Ссылка на объект (objects.id)                                   |
| opened_by            | UUID, FK    | Кто открыл смену (profiles.id)                                  |
| status               | TEXT        | Статус смены (open, draft, closed)                             |
| photo_url            | TEXT        | URL утреннего фото (опционально)                               |
| evening_photo_url    | TEXT        | URL вечернего фото (опционально)                               |
| created_at           | TIMESTAMP   | Дата и время создания записи (UTC)                              |
| updated_at           | TIMESTAMP   | Дата и время последнего обновления записи (UTC)                 |

**Количество записей:** 6

### RLS-политики (Row Level Security)

#### Политики для таблицы `work_hours`:

1. **Просмотр (SELECT):**
   - `Allow access to work_hours via works` — Доступ через связь с таблицей `works`
   - Условие: пользователь является админом или имеет доступ к объекту смены

2. **Вставка (INSERT):**
   - `Allow insert for work_hours via works` — Вставка через связь с `works`
   - Условие: пользователь может создавать записи для объектов, к которым имеет доступ

3. **Обновление (UPDATE):**
   - `Allow update for work_hours via works` — Обновление через связь с `works`
   - Условие: аналогично просмотру

4. **Удаление (DELETE):**
   - `Allow delete for work_hours via works` — Удаление через связь с `works`
   - Условие: аналогично просмотру

#### Политики для таблицы `works`:

1. **Основные операции (SELECT/INSERT/UPDATE/DELETE):**
   - Доступ предоставляется админам или пользователям с доступом к соответствующему объекту
   - Проверка через `profiles.object_ids @> ARRAY[works.object_id]`

### Связи между таблицами

```
work_hours  ←→  works  ←→  objects
     ↓
employees

Где:
- work_hours.work_id → works.id
- work_hours.employee_id → employees.id  
- works.object_id → objects.id
- works.opened_by → profiles.id
```

---

## Бизнес-логика и ключевые особенности

### Процесс обогащения данных (Data Enrichment)

Модуль использует сложный процесс обогащения данных:

1. **Получение базовых данных:** `TimesheetDataSourceImpl` выполняет JOIN между `work_hours` и `works` для получения дат, ID объектов и статуса смены
2. **Фильтрация закрытых смен:** На этапе загрузки данных из БД отбираются только записи часов из смен со статусом `'closed'`
3. **Обогащение в репозитории:** `TimesheetRepositoryImpl` добавляет:
   - Имена сотрудников (из модуля `employees`)
   - Названия объектов (из модуля `objects`)
   - Должности сотрудников
   - Форматированные имена (Фамилия Имя Отчество)
4. **Фильтрация сотрудников по статусу (обновлено 05.10.2025):**
   - Загружаются все сотрудники из модуля `employees`
   - Отбираются **активные сотрудники** (статус != 'fired')
   - Дополнительно отбираются **уволенные сотрудники с часами** в текущем периоде
   - Гарантирует отображение всех активных сотрудников и учёт часов уволенных

### Система поиска по ФИО

**Компоненты поиска:**
- **TimesheetSearchAction** — виджет поиска для AppBar с анимированным полем ввода
- **timesheetSearchQueryProvider** — провайдер состояния поискового запроса
- **timesheetSearchVisibleProvider** — провайдер видимости поля поиска
- **filterTimesheetByEmployeeName()** — утилита фильтрации записей по ФИО

**Особенности реализации:**
- Анимированное появление/скрытие поля поиска (220ms, easeInOut)
- Автофокус на поле ввода при открытии
- Иконка лупы превращается в крестик при наличии текста поиска
- Поиск по частичному совпадению в ФИО (case-insensitive)
- Автоматическая синхронизация контроллера с провайдером состояния

### Фильтрация (как в модуле «Выгрузка»)

Добавлена компактная панель фильтров, открываемая из AppBar:

**Компоненты:**
- `TimesheetSearchAction` — анимированный поиск по ФИО сотрудников с иконкой лупы.
- `TimesheetFiltersAction` — кнопка с иконкой настройки (tune) для открытия панели фильтров.
- Панель отображается как `PopupMenuItem` со скруглениями и обводкой в стиле приложения.

**Поля панели:**
- **Год**: одиночный выбор года через `GTDropdown` (диапазон ±5 лет от текущего года).
- **Месяц**: одиночный выбор месяца через `GTDropdown` (Январь–Декабрь).
- **Объекты**: множественный выбор через `GTDropdown` (мультивыбор).
- **Должности**: множественный выбор через `GTDropdown` (мультивыбор).

**Логика применения:**
- Фильтры редактируются в локальном состоянии панели (`_TimesheetFiltersPanelState`).
- **Кнопка "Сброс"** — вызывает `TimesheetNotifier.resetFilters()`, очищает все фильтры и закрывает панель.
- **Кнопка "Применить"** — применяет выбранные значения через `setDateRange()`, `setSelectedObjects()` и `setSelectedPositions()`, закрывает панель.
- Период рассчитывается автоматически: с 1-го числа до последнего дня выбранного месяца.
- Загрузка данных происходит только при нажатии кнопок, а не при каждом изменении выбора.

**Источники данных для панели:**
- `availableObjectsForTimesheetProvider` — список объектов из общего `objectProvider`.
- `availablePositionsForTimesheetProvider` — уникальные должности, загружаемые напрямую из `employeeRepositoryProvider`, независимо от текущих фильтров табеля (FutureProvider).

**Изменения в состоянии:**
- `TimesheetState.selectedObjectIds` — список выбранных объектов (мультивыбор), вместо одиночного `selectedObjectId`.
- `TimesheetState.selectedPositions` — список выбранных должностей (мультивыбор).
- Фильтры передаются в репозиторий для оптимизированной обработки.

### Экспорт в PDF

**Компоненты экспорта:**
- **TimesheetPdfService** — сервис генерации PDF с помощью пакета `pdf`.
- **TimesheetPdfAction** — кнопка в AppBar с иконкой PDF, сразу сохраняет файл при нажатии.

**Функционал:**
- **Сохранение файла** — экспорт табеля в PDF файл с автоматической генерацией имени (`Табель_ДД.ММ.ГГГГ_ДД.ММ.ГГГГ.pdf`).
- **Кроссплатформенность**: Web (через `FileSaver`), мобильные и десктоп (локальное сохранение через `path_provider`).
- **Простота использования**: один клик для сохранения, без дополнительных диалогов.

**Структура PDF (календарный вид - как в приложении):**
- Заголовок с названием "ТАБЕЛЬ РАБОЧЕГО ВРЕМЕНИ" и периодом.
- Таблица в календарном формате:
  - Колонки: ФИО (расширенная 140pt), даты месяца (по одной колонке на каждый день 28pt), Итого (35pt).
  - Две строки заголовка: числа месяца (1, 2, 3...) и дни недели (пн, вт, ср...).
  - Каждая строка — один сотрудник с часами по дням.
  - Выходные дни (сб, вс) выделены серым фоном.
  - Итоговая строка с суммами по каждому дню и общим итогом.
- Поддержка кириллицы через шрифты Google (Roboto).
- Альбомная ориентация (A4 landscape) для оптимального отображения таблицы.
- Компактные шрифты (7pt) для размещения всего месяца на одной странице.

**Интеграция с фильтрами:**
- Экспорт использует текущие отфильтрованные данные из `TimesheetState.entries`.
- Период автоматически берётся из `startDate` и `endDate` текущего состояния.

### Управление состоянием

**TimesheetState** содержит:
- `entries` — список записей табеля
- `isLoading` — состояние загрузки
- `error` — текст ошибки
- Фильтры: `startDate`, `endDate`, `selectedObjectIds`, `selectedPositions`

**TimesheetNotifier** управляет:
- Загрузкой данных с автоматическим обновлением при изменении фильтров
- Применением фильтров по объектам и должностям
- Обработкой ошибок и состояний загрузки

### Архитектурные решения

**Dependency Injection через Riverpod:**
- `supabaseClientProvider` — клиент Supabase
- `timesheetDataSourceProvider` — источник данных
- `timesheetRepositoryProvider` — репозиторий с внедрением зависимостей employee/object repositories
- `timesheetProvider` — провайдер состояния

**Разделение ответственности:**
- **DataSource** — работа с БД, JOIN-запросы, серверная и клиентская фильтрация
- **Repository** — обогащение данных, агрегация, бизнес-логика
- **Provider/Notifier** — управление состоянием UI, обработка пользовательских действий

**Оптимизация фильтрации (обновлено 04.10.2025):**
- **Серверная фильтрация** — применяется на уровне SQL запроса в Supabase:
  - Фильтрация по `employeeId` (прямое поле `work_hours.employee_id`)
  - Фильтрация только закрытых смен (`works.status = 'closed'`)
  - Значительно уменьшает объём данных, передаваемых от сервера к клиенту
- **Клиентская фильтрация** — применяется после получения данных:
  - Фильтрация по диапазону дат (`startDate`, `endDate`)
  - Фильтрация по списку объектов (`objectIds`)
  - Фильтрация по списку должностей (`positions`)
  - Необходима для полей из связанных таблиц через JOIN
- **Преимущества гибридного подхода:**
  - Снижение нагрузки на сеть (меньше данных передаётся)
  - Улучшенная производительность за счёт серверной фильтрации по статусу
  - Гибкость клиентской фильтрации для связанных данных
  - Быстрая работа даже при большом количестве записей

---

## Связи и интеграции

### Интеграция с другими модулями

- **Модуль "Работы"** — использует таблицы `work_hours` и `works` как источник данных
- **Модуль "Сотрудники"** — получает информацию о сотрудниках для обогащения данных
- **Модуль "Объекты"** — получает названия объектов для отображения
- **UI Framework** — интеграция с общими виджетами, темами, роутингом (go_router)

### Технические зависимости

- **Supabase Flutter** — основной клиент для работы с БД
- **Riverpod** — управление состоянием и DI
- **Freezed** — генерация иммутабельных классов
- **JsonSerializable** — сериализация/десериализация JSON
- **Logger** — логирование и отладка
- **pdf** — генерация PDF документов
- **file_saver** — сохранение файлов на Web платформе
- **path_provider** — доступ к директориям для сохранения файлов

### RLS и безопасность

- Все операции проходят через RLS-политики
- Доступ ограничен объектами пользователя или админскими правами
- Безопасное получение данных через существующие связи БД

---

## Текущие ограничения и планы развития

### Реализованные функции
- ✅ Поиск по ФИО сотрудников с анимированным полем в AppBar
- ✅ Фильтрация по году, месяцу, объектам (мультивыбор) и должностям (мультивыбор) с применением по кнопке
- ✅ Отображение только закрытых смен (status = 'closed')
- ✅ Экспорт табеля в PDF с автоматическим сохранением файла
- ✅ Просмотр часов в календарном виде
- ✅ Фильтрация и обогащение данных
- ✅ Адаптивный UI для всех платформ
- ✅ Интеграция с системой безопасности (RLS)
- ✅ Обогащение данных из связанных модулей
- ✅ Оптимизация фильтрации (гибридный подход: серверная + клиентская)
- ✅ **Отображение всех активных сотрудников (статус != 'fired') даже без часов** (05.10.2025)
- ✅ **Отображение уволенных сотрудников только при наличии часов в периоде** (05.10.2025)

### Планируемые улучшения
- 🔄 Экспорт данных в Excel/CSV
- 🔄 Inline-редактирование часов непосредственно из табеля
- 🔄 Уведомления об изменениях в табеле

### Технические улучшения
- 🔄 Покрытие unit-тестами всех компонентов
- 🔄 Integration-тесты с Supabase
- 🔄 Оптимизация производительности для больших объёмов данных
- 🔄 Поддержка офлайн-режима

---

## Примечания для разработчиков

- Все файлы снабжены подробными комментариями и поддерживают строгую типизацию
- Модуль легко расширяется и тестируется благодаря Clean Architecture и DI
- При изменениях в БД необходимо обновлять модели и источники данных
- **Для генерации кода:** выполните `flutter pub run build_runner build --delete-conflicting-outputs` из корневой директории проекта
- Соблюдайте принципы разделения ответственности между слоями архитектуры
- Вся документация модуля находится в `docs/timesheet_module.md`

**Последняя актуализация:** 05 октября 2025 года

**Ключевые обновления:**

**05.10.2025 — Логика отображения активных и уволенных сотрудников:**
- **Изменена логика репозитория (`TimesheetRepositoryImpl`):**
  - Теперь фильтрует активных сотрудников (статус != 'fired')
  - Добавляет уволенных сотрудников, только если у них есть часы в текущем периоде
  - Обеспечивает корректное отображение всех активных сотрудников в табеле
- **Обновлён календарный виджет (`TimesheetCalendarView`):**
  - Изменён на `ConsumerStatefulWidget` для доступа к `EmployeeRepository`
  - Загружает список всех сотрудников напрямую из репозитория
  - Фильтрует и сортирует сотрудников по статусу и ФИО
  - Отображает всех активных сотрудников, даже если у них нет часов
  - Отображает уволенных сотрудников только при наличии часов
  - Убран метод `_getEmployeePosition()` — должность теперь берётся напрямую из объекта `Employee`
- **Обновлён PDF-сервис (`TimesheetPdfService`):**
  - Добавлен конструктор с параметром `EmployeeRepository`
  - Реализована та же логика фильтрации активных и уволенных сотрудников
  - PDF-экспорт теперь отображает всех активных сотрудников (даже без часов)
  - Инициализация всех отфильтрованных сотрудников с пустыми картами часов
- **Обновлён PDF-экшн (`TimesheetPdfAction`):**
  - Добавлено чтение `employeeRepositoryProvider` из Riverpod
  - Передача репозитория в конструктор `TimesheetPdfService`
- **Преимущества изменений:**
  - Полный контроль над рабочим временем всех активных сотрудников
  - Корректный учёт часов уволенных сотрудников до момента увольнения
  - Консистентность между экраном табеля и PDF-экспортом
  - Прозрачная логика фильтрации на всех уровнях (репозиторий, UI, PDF)



**04.10.2025 — Оптимизация фильтрации:**
- **Реализована гибридная фильтрация:** серверная (Supabase) + клиентская
- **Серверная фильтрация:** `employeeId`, `works.status = 'closed'` — значительно уменьшает объём передаваемых данных
- **Клиентская фильтрация:** даты, объекты, должности — для полей из связанных таблиц через JOIN
- **Обновлены интерфейсы:** `TimesheetDataSource`, `TimesheetRepository` — добавлены параметры `objectIds` и `positions`
- **Оптимизирован провайдер:** `TimesheetNotifier.loadTimesheet()` теперь передаёт фильтры в репозиторий вместо локальной фильтрации
- **Улучшена производительность:** быстрая работа даже при большом количестве записей
- **Исправлен баг фильтра должностей:** `availablePositionsForTimesheetProvider` теперь загружает должности напрямую из `employeeRepositoryProvider` через `FutureProvider`, а не из отфильтрованных записей — все должности всегда доступны для выбора

**03.10.2025:**
- **Удалён мёртвый код:** удалены неиспользуемые файлы `timesheet_table_widget.dart`, `timesheet_summary.dart` и связанные модели
- **Упрощён провайдер состояния:** удалены неиспользуемые поля `summaries`, `selectedEmployeeIds`, `isGroupedByEmployee` и методы `toggleGrouping()`, `setSelectedEmployees()`
- **Упрощён репозиторий:** удалён неиспользуемый метод `getTimesheetSummary()`
- **Упрощён экспорт в PDF:** удалена функция печати, оставлено только сохранение файла одним кликом
- **Оптимизирован календарный виджет (`timesheet_calendar_view.dart`):**
  - Удалены неиспользуемые контроллеры прокрутки (`_dateScrollController`, `_employeeScrollController`)
  - Удалён нерабочий метод `_scrollToToday()`
  - Добавлен вспомогательный метод `_isSameDay()` для упрощения сравнения дат
  - Оптимизирована логика `_getUniqueEmployees()` — теперь вычисляется при необходимости, а не сохраняется в состоянии
  - Убран эффект выделения ячейки с ФИО при наведении
  - Упрощена структура диалога деталей записи
- **Оптимизирован основной экран (`timesheet_screen.dart`):**
  - Удалён хардкод цветов (`Colors.red`, `Colors.black`) — теперь используются цвета из темы
  - Упрощено отображение ошибок: заменён `Card` на `Container` с `BoxDecoration`
  - Улучшен loader: теперь использует `colorScheme.surface` с прозрачностью
  - Все элементы UI теперь адаптивны к светлой/тёмной теме
- **Удалены ненужные файлы и функции:**
  - Удалён устаревший `README.md` с дублирующей и неактуальной информацией
  - Удалён `build.sh` — генерация кода выполняется из корневой директории проекта
  - Удалена статистика результатов поиска — упрощён интерфейс экрана
  - Вся документация централизована в `docs/timesheet_module.md`
- Фильтрация только по объектам и должностям (множественный выбор)
- Отображение только закрытых смен (`status = 'closed'`)
- Календарное представление данных с адаптивным дизайном

--- 