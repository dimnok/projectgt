# üîß –û–¢–ß–ï–¢: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Å–º–µ–Ω

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Å–ø–∏—Å–∫–∞ —Å–º–µ–Ω –≤–º–µ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –µ–≥–æ ID.

## üîç –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **–ú–æ–¥—É–ª—å:** Works (–°–º–µ–Ω—ã)
- **–§–∞–π–ª:** `lib/features/works/presentation/screens/works_master_detail_screen.dart`
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:** –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–º–µ–Ω –≤ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–º –∏ –º–æ–±–∏–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–∞—Ö
- **–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã:** `worksProvider` (—Å–º–µ–Ω—ã) + `objectProvider` (–æ–±—ä–µ–∫—Ç—ã)

### üî¨ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

#### **–ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã: Race Condition + –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Riverpod API**

1. **Race Condition –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:**
   ```dart
   // –û–±–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∑–∞–ø—É—Å–∫–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
   final worksProvider = StateNotifierProvider<WorksNotifier, WorksState>((ref) {
     return WorksNotifier(repository)..loadWorks(); // ‚ö° –ó–∞–≥—Ä—É–∑–∫–∞ —Å–º–µ–Ω
   });
   
   final objectProvider = StateNotifierProvider<ObjectNotifier, ObjectState>((ref) {
     return ObjectNotifier(...)..loadObjects(); // ‚ö° –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤
   });
   ```

2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Riverpod API:**
   ```dart
   // ‚ùå –ü–†–û–ë–õ–ï–ú–ê: ref.read() - –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ —á—Ç–µ–Ω–∏–µ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏
   final objectName = ref.read(objectProvider).objects
       .where((o) => o.id == work.objectId)
       .map((o) => o.name)
       .firstOrNull ?? work.objectId; // Fallback –Ω–∞ ID
   
   // ‚úÖ –†–ï–®–ï–ù–ò–ï: ref.watch() - –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   final objectName = ref.watch(objectProvider).objects
       .where((o) => o.id == work.objectId)
       .map((o) => o.name)
       .firstOrNull ?? work.objectId;
   ```

#### **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
1. üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. ‚ö° `worksProvider` –∏ `objectProvider` –Ω–∞—á–∏–Ω–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
3. üèÉ‚Äç‚ôÇÔ∏è –°–º–µ–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –æ–±—ä–µ–∫—Ç–æ–≤
4. üé® UI —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Å `ref.read(objectProvider).objects` = `[]` (–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫)
5. üîÑ Fallback —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è `work.objectId`
6. üì¶ –û–±—ä–µ–∫—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ–∑–∂–µ
7. ‚ùå UI **–ù–ï** –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è (–Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ —á–µ—Ä–µ–∑ `ref.watch()`)
8. üëÅÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç ID –≤–º–µ—Å—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–π

## üõ†Ô∏è –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### üìç –ú–µ—Å—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

#### 1. **–ü–æ–∏—Å–∫ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º** (—Å—Ç—Ä–æ–∫–∏ 127-128)
```dart
// ‚ùå –î–æ:
final objectName = ref.read(objectProvider).objects
    .where((o) => o.id == w.objectId)
    .map((o) => o.name)
    .firstOrNull ?? '';

// ‚úÖ –ü–æ—Å–ª–µ:
final objectName = ref.watch(objectProvider).objects
    .where((o) => o.id == w.objectId)
    .map((o) => o.name)
    .firstOrNull ?? '';
```

#### 2. **–ö–∞—Ä—Ç–æ—á–∫–∏ —Å–º–µ–Ω (–¥–µ—Å–∫—Ç–æ–ø)** (—Å—Ç—Ä–æ–∫–∏ 265-268)
```dart
// ‚ùå –î–æ:
final objectName = ref.read(objectProvider).objects
    .where((o) => o.id == work.objectId)
    .map((o) => o.name)
    .firstOrNull ?? work.objectId;

// ‚úÖ –ü–æ—Å–ª–µ:
final objectName = ref.watch(objectProvider).objects
    .where((o) => o.id == work.objectId)
    .map((o) => o.name)
    .firstOrNull ?? work.objectId;
```

#### 3. **–ö–∞—Ä—Ç–æ—á–∫–∏ —Å–º–µ–Ω (–º–æ–±–∏–ª—å–Ω—ã–π)** (—Å—Ç—Ä–æ–∫–∏ 515-518)
```dart
// ‚ùå –î–æ:
final objectName = ref.read(objectProvider).objects
    .where((o) => o.id == work.objectId)
    .map((o) => o.name)
    .firstOrNull ?? work.objectId;

// ‚úÖ –ü–æ—Å–ª–µ:
final objectName = ref.watch(objectProvider).objects
    .where((o) => o.id == work.objectId)
    .map((o) => o.name)
    .firstOrNull ?? work.objectId;
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. **–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å UI:**
   - –í–∏–¥–∂–µ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ–±—ä–µ–∫—Ç–æ–≤
   - –ù–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

2. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
   - –ü—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ: –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è ID (fallback)
   - –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏—è

3. **–†–∞–±–æ—Ç–∞—é—â–∏–π –ø–æ–∏—Å–∫:**
   - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –æ–±—ä–µ–∫—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø–æ ID, —Ç–∞–∫ –∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º

4. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:**
   - –ü–æ–≤–µ–¥–µ–Ω–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–º –∏ –º–æ–±–∏–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–∞—Ö
   - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π –ø—Ä–æ–µ–∫—Ç–∞

### üìä –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
1. üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. ‚ö° `worksProvider` –∏ `objectProvider` –Ω–∞—á–∏–Ω–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
3. üèÉ‚Äç‚ôÇÔ∏è –°–º–µ–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –æ–±—ä–µ–∫—Ç–æ–≤
4. üé® UI —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Å `ref.watch(objectProvider).objects` = `[]`
5. üîÑ Fallback —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚Üí –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è `work.objectId`
6. üì¶ –û–±—ä–µ–∫—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
7. ‚úÖ UI **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è** (–ø–æ–¥–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ `ref.watch()`)
8. üëÅÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `lib/features/works/presentation/screens/works_master_detail_screen.dart`

### üéØ –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- –ü–æ–∏—Å–∫ —Å–º–µ–Ω –ø–æ –æ–±—ä–µ–∫—Ç–∞–º
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–º–µ–Ω –≤ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–º —Ä–µ–∂–∏–º–µ
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–º–µ–Ω –≤ –º–æ–±–∏–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:
- ‚úÖ Clean Architecture —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ Riverpod best practices –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- ‚úÖ –†–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–π –≤–∏–¥–∂–µ—Ç–æ–≤
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- [x] –î–µ—Å–∫—Ç–æ–ø–Ω—ã–π —Ä–µ–∂–∏–º - –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
- [x] –ú–æ–±–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º - –∫–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤  
- [x] –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –æ–±—ä–µ–∫—Ç–æ–≤
- [x] Fallback –Ω–∞ ID —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ–±—ä–µ–∫—Ç–∞
- [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö

### üîç Code Review:
- [x] –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Riverpod best practices
- [x] –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏
- [x] –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ memory leaks
- [x] –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ edge cases

## üéì –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### üìö –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏:
1. **Riverpod API:** –í–∞–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É `ref.read()` –∏ `ref.watch()`
2. **Race Conditions:** –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É—á–µ—Ç–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
3. **–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

### üîÆ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ:
1. **Code Review:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `ref.read()` vs `ref.watch()`
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –º–µ–¥–ª–µ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: ${DateTime.now().toString().split('.')[0]}*
*–°—Ç–∞—Ç—É—Å: ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞* 