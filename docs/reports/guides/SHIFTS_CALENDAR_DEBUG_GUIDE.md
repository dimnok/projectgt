# üîç –ü–û–õ–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–º–µ–Ω –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

## üìä –°–¢–ê–¢–£–° –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –°–µ—Ä–≤–µ—Ä: 33 –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `works` –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025
- Supabase API: –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç HTTP 200
- RLS –ø–æ–ª–∏—Ç–∏–∫–∏: –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç –¥–∞–Ω–Ω—ã–µ (–∞–¥–º–∏–Ω –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø)
- –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥: –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø—Ä–æ–≤–∞–π–¥–µ—Ä ‚Üí —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí datasource)

### ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫** (–≤—Å–µ –¥–Ω–∏ –∫—Ä–∞—Å–Ω—ã–µ)

---

## üîß –î–û–ë–ê–í–õ–ï–ù–ù–û–ï –õ–û–ì–ò–†–û–í–ê–ù–ò–ï

**–§–∞–π–ª:** `lib/features/home/data/datasources/shifts_data_source_impl.dart`

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:
```
üîç –ó–∞–ø—Ä–æ—Å —Å–º–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—è: –æ—Ç 2025-10-01 –¥–æ 2025-10-31
üì¶ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞–±–æ—Ç –∏–∑ Supabase: [X]
üìä –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –¥–Ω–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏: [Y]
üìã –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: [...]
```

---

## üì± –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨ –õ–û–ì–ò

### –í–∞—Ä–∏–∞–Ω—Ç 1: DevTools Flutter (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `flutter run`
2. –û—Ç–∫—Ä—ã—Ç—å DevTools: `flutter devtools`
3. –ü–µ—Ä–µ–π—Ç–∏ –≤ –≤–∫–ª–∞–¥–∫—É **Logging**
4. –ò—â–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å `üîç`, `üì¶`, `üìä`, `‚ùå`

### –í–∞—Ä–∏–∞–Ω—Ç 2: Android Studio / VS Code
1. –û—Ç–∫—Ä—ã—Ç—å **Logcat** / **Debug Console**
2. –§–∏–ª—å—Ç—Ä: `ShiftsDataSourceImpl` –∏–ª–∏ `shifts`
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä—è–º–æ –≤ –∫–æ–¥–µ (–ø–µ—á–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å)
```bash
flutter run -v  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

---

## üéØ –®–ê–ì –ó–ê –®–ê–ì–û–ú –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd /Users/dmitrit./projectgt
flutter run
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

**–ò—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
üîç –ó–∞–ø—Ä–æ—Å —Å–º–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—è: –æ—Ç 2025-10-01 –¥–æ 2025-10-31
```

**–ï—Å–ª–∏ –≤–∏–¥–Ω–æ:**
- ‚úÖ –≠—Ç–æ –∑–Ω–∞—á–∏—Ç `getShiftsForMonth` –±—ã–ª –≤—ã–∑–≤–∞–Ω
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –®–∞–≥—É 3

**–ï—Å–ª–∏ –ù–ï –≤–∏–¥–Ω–æ:**
- ‚ùå –ü—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω (–ª–∏–±–æ –∫—ç—à, –ª–∏–±–æ –æ—à–∏–±–∫–∞ –≤—ã—à–µ)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: `shiftsForMonthProvider` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ `ShiftsCalendarFlipCard`

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

**–ò—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ:**
```
üì¶ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞–±–æ—Ç –∏–∑ Supabase: 33
```

**–ï—Å–ª–∏ –≤–∏–¥–Ω–æ `33`:**
- ‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –®–∞–≥—É 4

**–ï—Å–ª–∏ –≤–∏–¥–Ω–æ `0`:**
- ‚ùå Supabase –≤–µ—Ä–Ω—É–ª –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
- **–ü—Ä–∏—á–∏–Ω—ã:**
  - RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø
  - –î–∞—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞
  - –î–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ—Ç –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü

**–ï—Å–ª–∏ –≤–∏–¥–Ω–æ –æ—à–∏–±–∫–∞:**
- ‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
- –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ò—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ:**
```
üìä –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –¥–Ω–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏: 18
üìã –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: [...]
```

**–ï—Å–ª–∏ –≤–∏–¥–Ω–æ —á–∏—Å–ª–æ > 0:**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–ª–∏—Å—å
- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –®–∞–≥—É 5

**–ï—Å–ª–∏ –≤–∏–¥–Ω–æ —á–∏—Å–ª–æ = 0:**
- ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –≤ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏
- –í–µ—Ä–æ—è—Ç–Ω–æ, `total_amount` –≤–µ–∑–¥–µ null –∏–ª–∏ 0
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î: `SELECT date, total_amount FROM works LIMIT 5`

---

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –≤ –≤–∏–¥–∂–µ—Ç

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
1. `shiftsForMonthProvider` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–Ω–µ–π
2. `ShiftsCalendarFlipCard` –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
3. `ShiftsHeatmap` —Ä–∏—Å—É–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å

**–ï—Å–ª–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –≤—Å—ë –µ—â—ë –ø—É—Å—Ç:**
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `ShiftsHeatmap.build()`:

```dart
@override
Widget build(BuildContext context) {
  print('üé® ShiftsHeatmap.build() - –ø–æ–ª—É—á–µ–Ω–æ –¥–Ω–µ–π: ${shifts.length}');
  print('üìã –î–∞–Ω–Ω—ã–µ shifts: $shifts');
  // ... rest of code
}
```

---

## üêõ –í–û–ó–ú–û–ñ–ù–´–ï –û–®–ò–ë–ö–ò –ò –†–ï–®–ï–ù–ò–Ø

### –û—à–∏–±–∫–∞ 1: HTTP 200, –Ω–æ –ø–æ–ª—É—á–µ–Ω–æ 0 —Ä–∞–±–æ—Ç

**–ü—Ä–∏–∑–Ω–∞–∫:**
```
üì¶ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞–±–æ—Ç –∏–∑ Supabase: 0
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚ùå RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç (—Ö–æ—Ç—è –∞–¥–º–∏–Ω –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å)
- ‚ùå –î–∞—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (–Ω–æ –º—ã –µ—ë –ø—Ä–æ–≤–µ—Ä–∏–ª–∏)
- ‚ùå –î–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã/–ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ –¥—Ä—É–≥–æ–π –ø–µ—Ä–∏–æ–¥

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Supabase SQL Editor
SELECT COUNT(*), MIN(date), MAX(date) FROM works;
-- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å >= 1 –∑–∞–ø–∏—Å—å –∑–∞ –æ–∫—Ç—è–±—Ä—å 2025
```

---

### –û—à–∏–±–∫–∞ 2: RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø

**–ü—Ä–∏–∑–Ω–∞–∫:**
```
‚ùå –û–®–ò–ë–ö–ê –≤ getShiftsForMonth: PostgrestException(...)
```

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –í Supabase SQL Editor
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT id, email, role, object_ids FROM profiles WHERE id = auth.uid();

-- –ï—Å–ª–∏ role –Ω–µ 'admin' ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å
UPDATE profiles SET role = 'admin' WHERE id = auth.uid();

-- –ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

---

### –û—à–∏–±–∫–∞ 3: –ü—Ä–æ–±–ª–µ–º–∞ –≤ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏

**–ü—Ä–∏–∑–Ω–∞–∫:**
```
üì¶ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞–±–æ—Ç –∏–∑ Supabase: 33
üìä –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –¥–Ω–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏: 0
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- `total_amount` –≤–µ–∑–¥–µ NULL –≤ –ë–î
- `DateTime.parse()` –ø–∞–¥–∞–µ—Ç –Ω–∞ –∫–∞–∫–æ–µ-—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
- –î–∞—Ç–∞ –Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ü–∏–∫–ª:

```dart
for (final work in responseList) {
  _log.d('üìù –û–±—Ä–∞–±–æ—Ç–∫–∞ work: ${work['date']}, total: ${work['total_amount']}');
  // ... rest
}
```

---

## üìã –ü–û–õ–ù–´–ô –ß–ï–ö-–õ–ò–°–¢

- [ ] –ó–∞–ø—É—Å—Ç–∏–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –£–≤–∏–¥–µ–ª –ª–æ–≥ `üîç –ó–∞–ø—Ä–æ—Å —Å–º–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—è:`
- [ ] –£–≤–∏–¥–µ–ª –ª–æ–≥ `üì¶ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞–±–æ—Ç: [—á–∏—Å–ª–æ]`
- [ ] –ß–∏—Å–ª–æ —Ä–∞–±–æ—Ç > 0
- [ ] –£–≤–∏–¥–µ–ª –ª–æ–≥ `üìä –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –¥–Ω–µ–π:`
- [ ] –ß–∏—Å–ª–æ –¥–Ω–µ–π > 0
- [ ] –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ ‚úÖ

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫:**
- –°–∫–æ–ø–∏—Ä—É–π –í–°–ï –ª–æ–≥–∏ —Å üîç –¥–æ ‚ùå
- –û—Ç–ø—Ä–∞–≤—å –Ω–∞–º –≤–º–µ—Å—Ç–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —á—Ç–æ –≤–∏–¥–∏—à—å

---

## üöÄ –ë–´–°–¢–†–ê–Ø –ü–†–û–í–ï–†–ö–ê

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –≤–æ–æ–±—â–µ:

```dart
// –î–æ–±–∞–≤–∏—Ç—å –≤ ShiftsCalendarFlipCard.build()
print('üéØ ShiftsCalendarFlipCard –ø–æ–ª—É—á–∏–ª shiftsAsync: $shiftsAsync');
```

–¢–æ–≥–¥–∞ —É–≤–∏–¥–∏—à—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ** - –≥–æ—Ç–æ–≤–æ –∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ
