# ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–∏—á–∏–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–π–¥–µ–Ω–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!

## üéØ **–†–ï–ê–õ–¨–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**

### ‚ùå –ë–´–õ –ë–ê–ì: DateTime —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–µ

**–§–∞–π–ª:** `lib/features/home/presentation/widgets/shifts_calendar_widgets.dart` (—Å—Ç—Ä–æ–∫–∞ 34)

```dart
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - new DateTime –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ build()
@override
Widget build(BuildContext context) {
  final now = DateTime.now();  // ‚Üê –ù–û–í–û–ï –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑!
  final shiftsAsync = ref.watch(shiftsForMonthProvider(now));
  // ...
}
```

### üí• **–ü–æ—á–µ–º—É —ç—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É:**

1. **–ö–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–µ** ‚Üí `now = DateTime.now()` —Å–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**
2. **Riverpod –≤–∏–¥–∏—Ç –¥—Ä—É–≥–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç** ‚Üí `shiftsForMonthProvider(new_now)` !== `shiftsForMonthProvider(old_now)`
3. **–ö—ç—à –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç** ‚Üí –ø—Ä–æ–≤–∞–π–¥–µ—Ä **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è**
4. **`when()` –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ `data`** ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è –≤ `loading`
5. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** üîÑ **–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**

---

## ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ö—ç—à–∏—Ä—É–µ–º DateTime –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**

```dart
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –∫—ç—à–∏—Ä—É–µ–º once –≤ initState
class _ShiftsCalendarFlipCardState extends ConsumerState<ShiftsCalendarFlipCard> {
  bool _flipped = false;
  DateTime? _selectedDate;
  double _selectedAmount = 0;
  late final DateTime _currentMonth;  // ‚Üê –ö—ç—à–∏—Ä—É–µ–º –æ–¥–∏–Ω —Ä–∞–∑

  @override
  void initState() {
    super.initState();
    // –í—ã—á–∏—Å–ª—è–µ–º –æ–¥–∏–Ω —Ä–∞–∑, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ–∑–¥–µ
    _currentMonth = DateTime.now();
  }

  @override
  Widget build(BuildContext context) {
    // –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –û–î–ù–û–û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    final shiftsAsync = ref.watch(shiftsForMonthProvider(_currentMonth));
    // ...
  }
}
```

### üîÑ **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–µ–ø–µ—Ä—å:**

1. **`initState` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑** ‚Üí `_currentMonth = DateTime.now()`
2. **`build()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –¥–∞—Ç—É** ‚Üí –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç
3. **Riverpod –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç** ‚Üí `when()` –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ `data`
4. **–î–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è** ‚Üí –∫–∞–ª–µ–Ω–¥–∞—Ä—å –≤–∏–¥–Ω–æ! ‚úÖ

---

## üìä **–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|-----------|------|-------|
| `DateTime` –≤ build() | ‚ùå –ù–æ–≤–æ–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑ | ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–æ –≤ initState |
| Riverpod –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| `when()` —Å–æ—Å—Ç–æ—è–Ω–∏–µ | ‚ùå –ü–æ—Å—Ç–æ—è–Ω–Ω–æ loading | ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ data |
| –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ | ‚ùå –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ | ‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤–∏–¥–Ω–æ |

---

## üöÄ **–î–ê–õ–¨–ù–ï–ô–®–ò–ï –î–ï–ô–°–¢–í–ò–Ø**

1. **–ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
```bash
flutter clean
flutter run
```

2. **–ü—Ä–æ–≤–µ—Ä—å –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω:**
- ‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è **—Å—Ä–∞–∑—É** (–±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏)
- ‚úÖ –ß–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞ –≤–∏–¥–Ω—ã –≤ –≤–∏–¥–µ —Ü–≤–µ—Ç–Ω—ã—Ö –∫–≤–∞–¥—Ä–∞—Ç–∏–∫–æ–≤
- ‚úÖ –î–Ω–∏ —Å —Ä–∞–±–æ—Ç–∞–º–∏ ‚Üí —Å–∏–Ω–∏–µ/–∑–µ–ª—ë–Ω—ã–µ
- ‚úÖ –î–Ω–∏ –±–µ–∑ —Ä–∞–±–æ—Ç ‚Üí –∫—Ä–∞—Å–Ω—ã–µ
- ‚úÖ –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –¥–µ–Ω—å ‚Üí –¥–µ—Ç–∞–ª–∏

3. **–ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:**
```
üîç –ó–∞–ø—Ä–æ—Å —Å–º–µ–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—è: –æ—Ç 2025-10-01 –¥–æ 2025-10-31
üì¶ –ü–æ–ª—É—á–µ–Ω–æ —Ä–∞–±–æ—Ç –∏–∑ Supabase: 33
üìä –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –¥–Ω–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏: 18
üìä ShiftsHeatmap –æ–±—Ä–∞–±–æ—Ç–∫–∞:
   –í—Ö–æ–¥—è—â–∏—Ö —Å–º–µ–Ω: 18
   –î–Ω–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏: 18
   Max –∑–Ω–∞—á–µ–Ω–∏–µ: 732162
```

---

## üìö **–ö–õ–Æ–ß–ï–í–û–ô –£–†–û–ö**

```dart
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - FutureProvider –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è
final data = ref.watch(myProvider(DateTime.now()));

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑—É–π —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
final cachedDate = useState(DateTime.now());
final data = ref.watch(myProvider(cachedDate.value));
```

**–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Riverpod `FutureProvider.family`:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **—Å—Ç–∞–±–∏–ª—å–Ω—ã** (–Ω–µ –º–µ–Ω—è—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–µ)
- –ò—Å–ø–æ–ª—å–∑—É–π `useState()` –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è–π –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–∞
- –ò–Ω–∞—á–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è**

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û**
