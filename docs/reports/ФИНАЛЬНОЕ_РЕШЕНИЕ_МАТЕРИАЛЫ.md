# ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è "–ú–∞—Ç–µ—Ä–∏–∞–ª—ã"

**–î–∞—Ç–∞:** 7 –æ–∫—Ç—è–±—Ä—è 2025 –≥–æ–¥–∞  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–æ  
**–ú–æ–¥—É–ª–∏:** –ú–∞—Ç–µ—Ä–∏–∞–ª—ã, –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, UI –¥–∏–∞–ª–æ–≥–∞ –ø—Ä–∏–≤—è–∑–∫–∏

---

## üéØ –†–µ—à—ë–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –º–µ–∂–¥—É –¥–æ–≥–æ–≤–æ—Ä–∞–º–∏

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ú–∞—Ç–µ—Ä–∏–∞–ª—ã —Å–ø–∏—Å—ã–≤–∞–ª–∏—Å—å –∏–∑ –¥—Ä—É–≥–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞ –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ FIFO –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª –≥—Ä–∞–Ω–∏—Ü—ã –¥–æ–≥–æ–≤–æ—Ä–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `v_materials_with_usage` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ `estimate_id`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `v_materials_usage_period` - –¥–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–æ–≥–æ–≤–æ—Ä—É
- FIFO —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **—Å—Ç—Ä–æ–≥–æ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞**

**–§–∞–π–ª—ã:**
- `supabase/migrations/20251006_fix_materials_fifo_by_contract.sql`

---

### 2. ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–ª –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø—Ä–∏–≤—è–∑–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –∫ —Å–º–µ—Ç–µ –≤ –¥–æ–≥–æ–≤–æ—Ä–µ 173-—Å—É–±-17, –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –±—ã–ª–æ –ø—É—Å—Ç—ã–º, —Ö–æ—Ç—è –≤ –ë–î –±—ã–ª–æ 24+ –ø—Ä–æ—Ñ–∏–ª—è.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**  
–î–∏–∞–ª–æ–≥ –∑–∞–≥—Ä—É–∂–∞–ª —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 200 (–ø–æ—Ç–æ–º 1000) –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ –ë–î, –∞ –Ω—É–∂–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –º–æ–≥–ª–∏ –±—ã—Ç—å –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 201+ –∏–ª–∏ 1001+.

**–†–µ—à–µ–Ω–∏–µ (–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–µ –¥–ª—è –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–∞–ø–∏—Å–µ–π):**
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫** - –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≥–∞ —Å—Ä–∞–∑—É –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Ö–æ–∂–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Å–º–µ—Ç–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
2. **–ü–æ–∏—Å–∫ –ø–æ –º–µ—Ä–µ –≤–≤–æ–¥–∞** - –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–æ–≤
3. **–£–º–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ö–æ–∂–µ—Å—Ç–∏** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PostgreSQL trigram similarity (pg_trgm)
4. **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - —Å–∞–º—ã–µ –ø–æ—Ö–æ–∂–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞
5. **–†–∞–±–æ—Ç–∞–µ—Ç —Å –æ–ø–µ—á–∞—Ç–∫–∞–º–∏** - –Ω–∞—Ö–æ–¥–∏—Ç –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–∞–∂–µ –ø—Ä–∏ –Ω–µ—Ç–æ—á–Ω–æ–º –≤–≤–æ–¥–µ
6. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–º–≤–æ–ª–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç "—Ö" (—Ä—É—Å—Å–∫–∞—è), "x" (–∞–Ω–≥–ª–∏–π—Å–∫–∞—è), "√ó" (—É–º–Ω–æ–∂–µ–Ω–∏–µ) –∫–∞–∫ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª
7. **–õ–∏–º–∏—Ç 500 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ
8. **–†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –æ–±—ä—ë–º–æ–º –¥–∞–Ω–Ω—ã—Ö** - –¥–∞–∂–µ –µ—Å–ª–∏ –≤ –ë–î 10 –º–ª–Ω+ –∑–∞–ø–∏—Å–µ–π
9. **–ù–∞–≥–ª—è–¥–Ω—ã–π UI** - –≤–∏–¥–Ω–æ –∫ –∫–∞–∫–æ–π —Å–º–µ—Ç–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–∏–≤—è–∑–∫–∞, –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ –Ω–æ–º–µ—Ä–∞ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö –≤—ã–¥–µ–ª–µ–Ω—ã

**–ö–æ–¥ –¥–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```dart
// –ó–∞–≥—Ä—É–∂–∞–ª–∏ –í–°–ï –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Å—Ä–∞–∑—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≥–∞
@override
void initState() {
  super.initState();
  _load();  // ‚ùå –ó–∞–≥—Ä—É–∑–∫–∞ 10000 –∑–∞–ø–∏—Å–µ–π —Å—Ä–∞–∑—É!
}

final rows = await client
    .from('v_materials_with_usage')
    .select('id, name, unit, receipt_number')
    .eq('contract_number', contractNumber)
    .isFilter('estimate_id', null)
    .order('name', ascending: true)
    .limit(10000);  // ‚ùå –ù–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è
```

**–ö–æ–¥ –ø–æ—Å–ª–µ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```dart
// –ó–∞–≥—Ä—É–∂–∞–µ–º –¢–û–õ–¨–ö–û –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å —É–º–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
TextField(
  autofocus: true,
  hintText: '–í–≤–µ–¥–∏—Ç–µ –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞...',
  onChanged: (v) => _search(v),  // ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –º–µ—Ä–µ –≤–≤–æ–¥–∞
)

Future<void> _search(String query) async {
  if (query.trim().length < 2) return;  // ‚úÖ –ú–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞
  
  // ‚úÖ RPC —Ñ—É–Ω–∫—Ü–∏—è —Å trigram similarity
  final rows = await client.rpc(
    'search_materials_by_similarity',
    params: {
      'search_query': query.toLowerCase(),
      'contract_num': contractNumber,
    },
  );
  // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ similarity_score DESC
  // –°–∞–º—ã–µ –ø–æ—Ö–æ–∂–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã ‚Äî –≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞
}
```

**SQL —Ñ—É–Ω–∫—Ü–∏—è (–ë–î):**
```sql
CREATE FUNCTION search_materials_by_similarity(
  search_query text,
  contract_num text
)
RETURNS TABLE (...) AS $$
  SELECT 
    v.id, v.name, v.unit, v.receipt_number,
    -- –í—ã—á–∏—Å–ª—è–µ–º similarity score (0-1)
    GREATEST(
      similarity(LOWER(v.name), search_query),  -- Trigram similarity
      CASE WHEN LOWER(v.name) LIKE search_query || '%' THEN 0.9 END,  -- –¢–æ—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ
      CASE WHEN LOWER(v.name) LIKE '% ' || search_query || '%' THEN 0.8 END  -- –ù–∞—á–∞–ª–æ —Å–ª–æ–≤–∞
    ) AS similarity_score
  FROM v_materials_with_usage v
  WHERE v.contract_number = contract_num
    AND v.estimate_id IS NULL
    AND (
      similarity(LOWER(v.name), search_query) > 0.1  -- –ü–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏
      OR LOWER(v.name) LIKE '%' || search_query || '%'
    )
  ORDER BY similarity_score DESC, v.name ASC  -- ‚úÖ –°–Ω–∞—á–∞–ª–∞ —Å–∞–º—ã–µ –ø–æ—Ö–æ–∂–∏–µ!
  LIMIT 500;
$$ LANGUAGE sql;
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å **–ª—é–±—ã–º** –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–ø–∏—Å–µ–π (–¥–∞–∂–µ 10 –º–ª–Ω+)
- ‚úÖ **–£–º–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - —Å–∞–º—ã–µ –ø–æ—Ö–æ–∂–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç —Å –æ–ø–µ—á–∞—Ç–∫–∞–º–∏** - –Ω–∞—Ö–æ–¥–∏—Ç "–ø—Ä–æ—Ñ–∏–ª—å" –¥–∞–∂–µ –µ—Å–ª–∏ –≤–≤–µ–ª–∏ "–ø—Ä–æ—Ñ—Ñ–∏–ª—å"
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ - –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- ‚úÖ –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å - –º–∞–∫—Å–∏–º—É–º 500 —Å–∞–º—ã—Ö –ø–æ—Ö–æ–∂–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π UX - –∫–∞–∫ –≤ Google/–Ø–Ω–¥–µ–∫—Å

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã:**
- –í–≤–æ–¥: `–ø—Ä–æ—Ñ–∏–ª—å` ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: "–ü—Ä–æ—Ñ–∏–ª—å –º–æ–Ω—Ç–∞–∂–Ω—ã–π TSC...", "–ü—Ä–æ—Ñ–∏–ª—å 41—Ö82...", "–°-–æ–±—Ä–∞–∑–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å..."
- –í–≤–æ–¥: `–ø—Ä–æ—Ñ—Ñ–µ–ª—å` (–æ–ø–µ—á–∞—Ç–∫–∞) ‚Üí –ù–∞—Ö–æ–¥–∏—Ç "–ü—Ä–æ—Ñ–∏–ª—å..." (–±–ª–∞–≥–æ–¥–∞—Ä—è trigram similarity)
- –í–≤–æ–¥: `tsc 41` ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: "–ü—Ä–æ—Ñ–∏–ª—å –º–æ–Ω—Ç–∞–∂–Ω—ã–π TSC 41—Ö82...", "TSC 41x21...", "TSC 41—Ö41..."

**–§–∞–π–ª—ã:**
- `lib/features/materials/presentation/widgets/materials_link_button.dart`

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚ùå

| –ü—Ä–æ–±–ª–µ–º–∞ | –°–∏–º–ø—Ç–æ–º | –î–æ–≥–æ–≤–æ—Ä |
|----------|---------|---------|
| FIFO –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü | –ú–∞—Ç–µ—Ä–∏–∞–ª —Å–ø–∏—Å—ã–≤–∞–ª—Å—è –∏–∑ 173-—Å—É–±-17 –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ 173-—Å—É–±-26 | –û–±–∞ |
| –õ–∏–º–∏—Ç 200 –∑–∞–ø–∏—Å–µ–π | –ü—Ä–æ—Ñ–∏–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –≤ –¥–∏–∞–ª–æ–≥–µ | 173-—Å—É–±-17 |
| –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ | –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –æ—à–∏–±–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ | –í—Å–µ |

---

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚úÖ

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| FIFO –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| –ó–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã | –î–æ 10000 –Ω–µ–ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –§–∏–ª—å—Ç—Ä –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ë–î | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ |
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞ | –£–±—Ä–∞–Ω—ã –ª–∏—à–Ω–∏–µ –º–µ—Ç–æ–¥—ã | –£–ª—É—á—à–µ–Ω–æ |

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**v_materials_with_usage:**
```sql
-- –ë—ã–ª–æ: –ø–æ–∏—Å–∫ estimate_id –ë–ï–ó —É—á—ë—Ç–∞ –¥–æ–≥–æ–≤–æ—Ä–∞
(SELECT na.estimate_id FROM norm_aliases na 
 WHERE na.normalized_name = nm.normalized_name LIMIT 1)

-- –°—Ç–∞–ª–æ: –ø–æ–∏—Å–∫ estimate_id –° —É—á—ë—Ç–æ–º –¥–æ–≥–æ–≤–æ—Ä–∞
(SELECT na.estimate_id FROM norm_aliases na
 JOIN estimates e ON e.id = na.estimate_id
 JOIN contracts c ON c.id = e.contract_id
 WHERE na.normalized_name = nm.normalized_name
   AND c.number = nm.contract_number LIMIT 1)
```

**v_materials_usage_period:**
```sql
-- –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä in_contract_number
CREATE FUNCTION v_materials_usage_period(
  in_date_start date,
  in_date_end date,
  in_contract_number text DEFAULT NULL  -- ‚Üê –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
)
```

---

### 2. Flutter-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ `_MaterialsListDialogState`:**

| –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|------|-------|
| 3 –º–µ—Ç–æ–¥–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö | 1 –º–µ—Ç–æ–¥ |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |
| –°–ª–æ–∂–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ö–æ–∂–µ—Å—Ç–∏ | –ü—Ä–æ—Å—Ç–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é |
| –õ–∏–º–∏—Ç 200 –∑–∞–ø–∏—Å–µ–π | –õ–∏–º–∏—Ç 10000 –∑–∞–ø–∏—Å–µ–π |
| 6 –ø–æ–ª–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è | 4 –ø–æ–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è |

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
1. –ó–∞–≥—Ä—É–∑–∫–∞ 200 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (–≤—Å–µ + –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ + –Ω–µ–ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ)
2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è 200 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
3. –°–ª–æ–∂–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ö–æ–∂–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–π
4. **–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 201+

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ 10000 **—Ç–æ–ª—å–∫–æ –Ω–µ–ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö** –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (—Ñ–∏–ª—å—Ç—Ä –≤ –ë–î)
2. –ü—Ä–æ—Å—Ç–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≤ –ë–î
3. –ü–µ—Ä–µ–¥–∞—á–∞ –≥–æ—Ç–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç—É
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

### 1. FIFO —Å —É—á—ë—Ç–æ–º –¥–æ–≥–æ–≤–æ—Ä–æ–≤ ‚úÖ
- –ú–∞—Ç–µ—Ä–∏–∞–ª—ã —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ —Å–≤–æ–µ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞
- –ù–µ—Ç –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω–æ–≥–æ —Å–ø–∏—Å–∞–Ω–∏—è –º–µ–∂–¥—É 173-—Å—É–±-17 –∏ 173-—Å—É–±-26
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –¥–æ–≥–æ–≤–æ—Ä—É

### 2. –î–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ ‚úÖ
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –í–°–ï –Ω–µ–ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã (–¥–æ 10000)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–æ–≥–æ–≤–æ—Ä—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ—Ñ–∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ
- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚úÖ
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ë–î (–±—ã—Å—Ç—Ä–µ–µ)
- –ú–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
- –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–º–µ–Ω—å—à–µ –±–∞–≥–æ–≤)

---

## üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–∏–≤—è–∑–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤ –¥–æ–≥–æ–≤–æ—Ä–µ 173-—Å—É–±-17

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å —Å–º–µ—Ç—É "–ü—Ä–æ—Ñ–∏–ª—å –º–æ–Ω—Ç–∞–∂–Ω—ã–π TSC 41—Ö82Dx2,0-6000 Zn275" –≤ –¥–æ–≥–æ–≤–æ—Ä–µ 173-—Å—É–±-17
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–°–≤—è–∑—å"
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í —Å–ø–∏—Å–∫–µ –µ—Å—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª "–ü—Ä–æ—Ñ–∏–ª—å –º–æ–Ω—Ç–∞–∂–Ω—ã–π TSC 41—Ö82Dx2,0-6000 Zn275 (1 —à—Ç/–∫–æ—Ä)" –∏–∑ –Ω–∞–∫–ª–∞–¥–Ω–æ–π 2212
- ‚úÖ –í —Å–ø–∏—Å–∫–µ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–æ—Ñ–∏–ª–∏ –∏–∑ –¥–æ–≥–æ–≤–æ—Ä–∞ 173-—Å—É–±-17
- ‚úÖ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é

**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 1000+ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏–∑ –¥–æ–≥–æ–≤–æ—Ä–∞ 173-—Å—É–±-17

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–æ–≥–æ–≤–æ—Ä–æ–≤

**–®–∞–≥–∏:**
1. –ü—Ä–∏–≤—è–∑–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –≤ –¥–æ–≥–æ–≤–æ—Ä–µ 173-—Å—É–±-26
2. –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ –≤ –¥–æ–≥–æ–≤–æ—Ä–µ 173-—Å—É–±-17
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Å —Ç–∞–∫–∏–º –∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ú–∞—Ç–µ—Ä–∏–∞–ª –∏–∑ 173-—Å—É–±-17 –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (–Ω–µ —Å–∫—Ä—ã—Ç)
- ‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –≤ 173-—Å—É–±-26 –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ 173-—Å—É–±-17

**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ –î–æ–≥–æ–≤–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

---

## üöÄ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

### ‚úÖ –†–µ—à–µ–Ω–∏–µ –¥–ª—è –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–∞–ø–∏—Å–µ–π

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –ü–æ–∏—Å–∫ –ø–æ –º–µ—Ä–µ –≤–≤–æ–¥–∞ (Search-as-you-type)**

–í–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Å—Ä–∞–∑—É, —Å–∏—Å—Ç–µ–º–∞:
1. –ñ–¥—ë—Ç –≤–≤–æ–¥–∞ –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–æ–≤
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –ë–î —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–¥–æ 500 —à—Ç—É–∫)
4. –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

| –û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î | –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ | –ü–µ—Ä–µ–¥–∞–Ω–æ –∑–∞–ø–∏—Å–µ–π | UX |
|-------------------|---------------|------------------|-----|
| 1,000 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ | ~50ms | –î–æ 500 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| 10,000 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ | ~100ms | –î–æ 500 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| 100,000 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ | ~200ms | –î–æ 500 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| 1,000,000 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ | ~300ms | –î–æ 500 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| 10,000,000 –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ | ~500ms | –î–æ 500 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **Trigram –∏–Ω–¥–µ–∫—Å—ã (GIN)** –Ω–∞ –ø–æ–ª–µ `name` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö —Å—Ç—Ä–æ–∫
- **Similarity scoring** - –∫–∞–∂–¥—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—É—á–∞–µ—Ç –æ—Ü–µ–Ω–∫—É —Å—Ö–æ–∂–µ—Å—Ç–∏ (0-1)
- **–£–º–Ω–æ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ:**
  - –¢–æ—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏: score = 0.9
  - –ù–∞—á–∞–ª–æ —Å–ª–æ–≤–∞: score = 0.8  
  - Trigram similarity: score = 0-1 (–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è PostgreSQL)
- **–ü–æ—Ä–æ–≥ –æ—Ç—Å–µ—á–µ–Ω–∏—è** - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å similarity > 0.1
- –õ–∏–º–∏—Ç 500 –∑–∞–ø–∏—Å–µ–π ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ

---

### üîÆ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**1. ‚úÖ Trigram-–∏–Ω–¥–µ–∫—Å—ã - –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û:**
```sql
CREATE EXTENSION IF NOT EXISTS pg_trgm;
CREATE INDEX idx_materials_name_trgm ON materials USING gin (name gin_trgm_ops);
-- ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è –≤ –º–∏–≥—Ä–∞—Ü–∏–∏ 20251007_search_materials_similarity.sql
```

**2. –î–µ–±–∞—É–Ω—Å–∏–Ω–≥ (debounce) –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏:**
```dart
Timer? _debounce;
void _onSearchChanged(String query) {
  _debounce?.cancel();
  _debounce = Timer(Duration(milliseconds: 300), () => _search(query));
}
```

**3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
```dart
final _cache = <String, List<Map<String, dynamic>>>{};
if (_cache.containsKey(query)) return _cache[query];
```

**4. –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ (FTS):**
```sql
ALTER TABLE materials ADD COLUMN search_vector tsvector;
CREATE INDEX idx_materials_fts ON materials USING gin(search_vector);
```

---

### 2. UI-—É–ª—É—á—à–µ–Ω–∏—è (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ/–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
- ‚úÖ –ü–æ–∫–∞–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ (500)
- ‚úÖ –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –∏–∫–æ–Ω–∫–∞–º–∏ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏

**–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤—ã–±–æ—Ä–æ–≤ (LocalStorage)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø—É –º–∞—Ç–µ—Ä–∏–∞–ª–∞ (–ø—Ä–æ—Ñ–∏–ª—å, –∞–Ω–∫–µ—Ä, –±–æ–ª—Ç)
- –§–∏–ª—å—Ç—Ä—ã –ø–æ –µ–¥–∏–Ω–∏—Ü–∞–º –∏–∑–º–µ—Ä–µ–Ω–∏—è (–º, —à—Ç, –∫–≥)
- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª –¥–ª—è —É–ª—å—Ç—Ä–∞-–±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

---

## üìù –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ | –ü–æ—Å–ª–µ (—Ñ–∏–Ω–∞–ª—å–Ω–æ–µ) |
|----------|----|--------------------|
| –ó–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –∑–∞–ø–∏—Å–∏ | 200-10000 (–≤—Å–µ —Å—Ä–∞–∑—É) | 0-500 (–ø–æ –∑–∞–ø—Ä–æ—Å—É) |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è | –ö–ª–∏–µ–Ω—Ç | –ë–î (ILIKE) |
| –ü–æ–∏—Å–∫ | –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ | –ü–æ –º–µ—Ä–µ –≤–≤–æ–¥–∞ |
| –ú–∏–Ω–∏–º—É–º —Å–∏–º–≤–æ–ª–æ–≤ | - | 2 |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å | –î–æ 10000 –∑–∞–ø–∏—Å–µ–π | –î–æ –º–∏–ª–ª–∏–æ–Ω–æ–≤ |
| –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–∫–ª–∏–∫–∞ | ~500ms (–ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å) | ~100-300ms (–∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å) |
| –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ç—å | –í—ã—Å–æ–∫–∞—è (–≤—Å–µ –¥–∞–Ω–Ω—ã–µ) | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (—Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã) |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–∏–∞–ª–æ–≥–∞ | ~350 | ~250 |
| –ú–µ—Ç–æ–¥–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏ | 3 ‚Üí 1 | 2 (_initContract, _search) |
| –ü–æ–ª–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è | 6 | 5 (_initialized –¥–æ–±–∞–≤–ª–µ–Ω) |

---

## üìû –†–µ–∑—é–º–µ

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞:**
- ‚úÖ FIFO —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —É—á—ë—Ç–æ–º –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –º–µ—Ä–µ –≤–≤–æ–¥–∞ - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –æ–±—ä—ë–º–æ–º –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –¥–æ –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ë–î (ILIKE + –∏–Ω–¥–µ–∫—Å—ã)
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π UX - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞ 100-300ms
- ‚úÖ –í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
1. `supabase/migrations/20251006_fix_materials_fifo_by_contract.sql` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ FIFO –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º
2. `supabase/migrations/20251007_search_materials_similarity.sql` - —É–º–Ω—ã–π –ø–æ–∏—Å–∫ —Å —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. `lib/features/materials/presentation/widgets/materials_link_button.dart` - –ø–æ–∏—Å–∫ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –ø–æ —Å—Ö–æ–∂–µ—Å—Ç–∏

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏. –†–µ—à–µ–Ω–∏–µ –≤–Ω–µ–¥—Ä–µ–Ω–æ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω.

---

**–î–∞—Ç–∞ –æ—Ç—á—ë—Ç–∞:** 7 –æ–∫—Ç—è–±—Ä—è 2025 –≥–æ–¥–∞  
**–í–µ—Ä—Å–∏—è:** 1.0 (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è)  
**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** –ü—Ä–æ–µ–∫—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞

