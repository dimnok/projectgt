# –ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏—è–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Version Management System)

**–î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏:** 16 –æ–∫—Ç—è–±—Ä—è 2025 –≥–æ–¥–∞ (–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å Realtime)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü—Ä–æ–¥–∞–∫—à–Ω-–≥–æ—Ç–æ–≤–æ  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã:** iOS, Android, Web (–µ–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –≤—Å–µ—Ö)

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

| –ß—Ç–æ | –ì–¥–µ | –ö–∞–∫ |
|-----|-----|-----|
| **–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** | `lib/core/constants/app_constants.dart` | `AppConstants.appVersion` |
| **–¢–∞–±–ª–∏—Ü–∞ –ë–î** | Supabase `app_versions` | 1 –∑–∞–ø–∏—Å—å —Å `current_version`, `minimum_version`, `force_update` |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏** | `main.dart` —Å—Ç—Ä–æ–∫–∞ 139 | `watchAppVersionProvider` (Realtime Stream) |
| **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–µ—Ä—Å–∏–∏** | `/force-update` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ `current < minimum_version` |
| **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** | `/settings/version-management` | –¢–æ–ª—å–∫–æ –¥–ª—è `role='admin'` |
| **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π** | `lib/core/utils/version_utils.dart` | `VersionUtils.compareVersions()` |
| **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–∞–Ω–Ω—ã—Ö** | `lib/data/repositories/version_repository.dart` | `getVersionInfo()`, `watchVersionChanges()`, `updateVersion()` |
| **RLS –ø–æ–ª–∏—Ç–∏–∫–∏** | –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î | –ß–∏—Ç–∞—é—Ç –≤—Å–µ, –ø–∏—à—É—Ç —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã |
| **Realtime** | Supabase publication | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `app_versions` |

---

## –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö

> **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
> - **–û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `app_versions`** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏—è–º–∏ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
> - **Realtime —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
> - **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ RLS** ‚Äî —á–∏—Ç–∞—é—Ç –≤—Å–µ, –ø–∏—à—É—Ç —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã
> - **–ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Ä–∞–±–æ—Ç–∞** ‚Äî –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–æ –≤ `main.dart`

---

## –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –º–æ–¥—É–ª—å?

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏—è–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ä–µ—à–∞–µ—Ç **–∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É** ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/–≤—ã–ø—É—Å–∫ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ production:

‚úÖ **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** ‚Äî –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–∞—Ö –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏  
‚úÖ **Graceful –≤—ã–ø—É—Å–∫** ‚Äî –ø–ª–∞–≤–Ω–æ–µ –≤—ã–≤–µ–¥–µ–Ω–∏–µ –∏–∑ —Å—Ç—Ä–æ—è —É—Å—Ç–∞—Ä–µ–≤—à–µ–π –≤–µ—Ä—Å–∏–∏  
‚úÖ **Realtime —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º **–∑–∞ —Å–µ–∫—É–Ω–¥—É**, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏  
‚úÖ **–ï–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º** ‚Äî –Ω–µ—Ç –ø—É—Ç–∞–Ω–∏—Ü—ã –º–µ–∂–¥—É iOS, Android, Web  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –∏–∑–º–µ–Ω—è—Ç—å –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —á–µ—Ä–µ–∑ RLS –ø–æ–ª–∏—Ç–∏–∫–∏

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ** | –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è |
| **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π** | –ï—Å–ª–∏ —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è < `minimum_version` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** | –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∏—Ç—å —Ñ–ª–∞–≥ `force_update` –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |
| **Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** | –ß–µ—Ä–µ–∑ Supabase Realtime –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞ ~1 —Å–µ–∫ |
| **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** | –≠–∫—Ä–∞–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏—è–º–∏ (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—å—é `admin`) |
| **–ü–µ—Ä–µ–≤–æ–¥–∏–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** ‚Äî –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ (–Ω–∞ —Ä—É—Å—Å–∫–æ–º) |

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ñ–∞–π–ª—ã –º–æ–¥—É–ª—è

### üìÇ –ò–µ—Ä–∞—Ä—Ö–∏—è —Ñ–∞–π–ª–æ–≤

```
lib/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ constants/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app_constants.dart              # –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –≤–µ—Ä—Å–∏–∏ (1.0.2)
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îî‚îÄ‚îÄ version_utils.dart              # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app_version_model.dart          # –ú–æ–¥–µ–ª—å –¥–ª—è JSON-—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ repositories/
‚îÇ       ‚îî‚îÄ‚îÄ version_repository.dart         # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
‚îÇ
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îî‚îÄ‚îÄ entities/
‚îÇ       ‚îî‚îÄ‚îÄ app_version.dart                # –°—É—â–Ω–æ—Å—Ç—å –≤–µ—Ä—Å–∏–∏ (Freezed)
‚îÇ
‚îî‚îÄ‚îÄ features/
    ‚îî‚îÄ‚îÄ version_control/
        ‚îú‚îÄ‚îÄ presentation/
        ‚îÇ   ‚îú‚îÄ‚îÄ version_management_screen.dart   # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        ‚îÇ   ‚îî‚îÄ‚îÄ force_update_screen.dart         # –≠–∫—Ä–∞–Ω –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        ‚îî‚îÄ‚îÄ providers/
            ‚îî‚îÄ‚îÄ version_providers.dart           # Riverpod –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

supabase/migrations/
‚îî‚îÄ‚îÄ 20251005054905_create_app_versions_table.sql  # –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: –¢–∞–±–ª–∏—Ü–∞ `app_versions`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | Nullable | Default | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|---------|---------|
| **id** | UUID | ‚ùå | `gen_random_uuid()` | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏ |
| **current_version** | TEXT | ‚ùå | ‚Äî | **–¢–µ–∫—É—â–∞—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (e.g. "1.0.3"). –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø |
| **minimum_version** | TEXT | ‚ùå | ‚Äî | **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –≤–µ—Ä—Å–∏—è**. –í–µ—Ä—Å–∏–∏ –Ω–∏–∂–µ —ç—Ç–æ–≥–æ –±—É–¥—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã (e.g. "1.0.2") |
| **force_update** | BOOLEAN | ‚úÖ | `false` | **–§–ª–∞–≥ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**. –ï—Å–ª–∏ `true` ‚Äî –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| **update_message** | TEXT | ‚úÖ | NULL | **–ö–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ (e.g. "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω") |
| **created_at** | TIMESTAMPTZ | ‚úÖ | `now()` | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ |
| **updated_at** | TIMESTAMPTZ | ‚úÖ | `now()` | –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ (1 –∑–∞–ø–∏—Å—å)

```
id                  | 383c87f5-11b5-4d6f-8074-ca8fda7c1bc6
current_version     | 1.0.3
minimum_version     | 1.0.2
force_update        | true
update_message      | "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏"
created_at          | 2025-10-05 18:31:31 UTC
updated_at          | 2025-10-16 08:23:55 UTC
```

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π:** 1 (–≤—Å–µ–≥–¥–∞ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º)  
**RLS:** ‚úÖ –í–∫–ª—é—á—ë–Ω

### RLS-–ø–æ–ª–∏—Ç–∏–∫–∏

#### 1Ô∏è‚É£ –ü–æ–ª–∏—Ç–∏–∫–∞ –Ω–∞ SELECT (—á—Ç–µ–Ω–∏–µ)
```sql
CREATE POLICY "–í—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
  ON app_versions FOR SELECT
  TO authenticated
  USING (true);
```
‚úÖ **–í—Å–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Ä—Å–∏–∏

#### 2Ô∏è‚É£ –ü–æ–ª–∏—Ç–∏–∫–∞ –Ω–∞ UPDATE/INSERT/DELETE (–∑–∞–ø–∏—Å—å)
```sql
CREATE POLICY "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é"
  ON app_versions FOR ALL
  TO authenticated
  USING (
    EXISTS (
      SELECT 1 FROM public.profiles
      WHERE profiles.id = auth.uid()
      AND profiles.role = 'admin'
    )
  );
```
‚úÖ **–¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—å—é `admin`** –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ (RLS –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω, –¥–≤–µ —á—ë—Ç–∫–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏)

### Realtime –≤–∫–ª—é—á–µ–Ω–∏–µ

```sql
ALTER PUBLICATION supabase_realtime ADD TABLE app_versions;
```

‚úÖ **Realtime –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∏ –ø–æ–ª—É—á–∞—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ –∫–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1Ô∏è‚É£ –§–æ—Ä–º–∞—Ç –≤–µ—Ä—Å–∏–∏

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: `major.minor.patch`

–ü—Ä–∏–º–µ—Ä—ã:
- `1.0.0` ‚Üí –ø–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑
- `1.2.3` ‚Üí –≤–µ—Ä—Å–∏—è 1, –º–∏–Ω–æ—Ä 2, –ø–∞—Ç—á 3
- `2.0.0` ‚Üí –º–∞–∂–æ—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (breaking changes)

### 2Ô∏è‚É£ –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–∏

#### –ù–∞ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (main.dart)

```dart
// main.dart: –°–ª—É—à–∞–Ω–∏–µ Realtime –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–µ—Ä—Å–∏–∏
ref.listen<AsyncValue<dynamic>>(
  watchAppVersionProvider,
  (previous, next) {
    next.whenData((versionInfo) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º: —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è >= –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π?
      final isSupported = VersionUtils.isVersionSupported(
        AppConstants.appVersion,  // 1.0.2
        versionInfo.minimumVersion,  // 1.0.2
      );

      // –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
      if (!isSupported) {
        final router = ref.read(routerProvider);
        router.go('/force-update');  // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —ç–∫—Ä–∞–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
      }
    });
  },
);
```

#### –§—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π (VersionUtils)

```dart
static int compareVersions(String current, String minimum) {
  // –ü—Ä–∏–º–µ—Ä: compareVersions('1.2.3', '1.2.0') ‚Üí 1 (current > minimum)
  
  final currentParts = current.split('.').map(int.parse).toList();
  final minimumParts = minimum.split('.').map(int.parse).toList();
  
  // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º: major ‚Üí minor ‚Üí patch
  for (int i = 0; i < 3; i++) {
    if (currentParts[i] > minimumParts[i]) return 1;   // current –±–æ–ª—å—à–µ
    if (currentParts[i] < minimumParts[i]) return -1;  // current –º–µ–Ω—å—à–µ
  }
  return 0;  // –†–∞–≤–Ω—ã
}

static bool isVersionSupported(String current, String minimum) {
  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç true –µ—Å–ª–∏ current >= minimum
  return compareVersions(current, minimum) >= 0;
}
```

### 3Ô∏è‚É£ –°—Ü–µ–Ω–∞—Ä–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π | `minimum_version` | –î–µ–π—Å—Ç–≤–∏–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-------------------|---------|-----------|
| **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥** | –ü–æ–≤—ã—à–∞–µ–º (e.g. `1.0.2` ‚Üí `1.0.3`) | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1.0.2 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω | –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `/force-update` |
| **–ü–ª–∞–≤–Ω—ã–π –≤—ã–ø—É—Å–∫** | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª (–Ω–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π) | –°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —Å–ø–æ–∫–æ–π–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç | –†–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ |
| **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** | –í–∫–ª—é—á–∞–µ–º `force_update = true` | –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–ª—É—á–∞—Ç Realtime —Å–æ–±—ã—Ç–∏–µ | –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
| **–û—Ç–∫–∞—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** | `force_update = false` + –ø–æ–Ω–∏–∑–∏—Ç—å `minimum_version` | –û—Ç–º–µ–Ω—è–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–µ—Ä–Ω—É—Ç –¥–æ—Å—Ç—É–ø |

### 4Ô∏è‚É£ Realtime —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**

```
–ê–¥–º–∏–Ω –∏–∑–º–µ–Ω—è–µ—Ç –≤–µ—Ä—Å–∏—é
    ‚Üì
Supabase –ë–î –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
    ‚Üì
Realtime –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ (~1 —Å–µ–∫)
    ‚Üì
–í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Stream
    ‚Üì
watchAppVersionProvider —É–≤–µ–¥–æ–º–ª—è–µ—Ç —Å–ª—É—à–∞—Ç–µ–ª–µ–π
    ‚Üì
main.dart –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
```

**–ü—Ä–∏–º–µ—Ä –ø–æ–ª–ª–∏–Ω–≥–∞ –≤–µ—Ä—Å–∏–∏ (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π):**

```dart
// –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫
Timer.periodic(const Duration(seconds: 60), (_) async {
  final repository = ref.read(versionRepositoryProvider);
  final versionInfo = await repository.getVersionInfo();
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏–º –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
});
```

### 5Ô∏è‚É£ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–≠–∫—Ä–∞–Ω:** `/settings/version-management`  
**–î–æ—Å—Ç—É–ø:** –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—å—é `admin`

**–§—É–Ω–∫—Ü–∏–∏:**
- üìù –í–≤–æ–¥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞ `\d+\.\d+\.\d+`)
- üì® –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- üîí –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- üíæ –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º
- üïê –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

---

## –°–≤—è–∑–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –î–∏–∞–≥—Ä–∞–º–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Supabase app_versions          ‚îÇ
‚îÇ  (1 –∑–∞–ø–∏—Å—å –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º)          ‚îÇ
‚îÇ  - current_version                     ‚îÇ
‚îÇ  - minimum_version                     ‚îÇ
‚îÇ  - force_update (boolean)              ‚îÇ
‚îÇ  - update_message                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚îÇ Realtime Stream
             ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      VersionRepository (data layer)    ‚îÇ
‚îÇ  - getVersionInfo()                    ‚îÇ
‚îÇ  - watchVersionChanges() ‚Üí Stream      ‚îÇ
‚îÇ  - updateVersion() [–∞–¥–º–∏–Ω only]        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚îÇ Riverpod –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
             ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     version_providers.dart             ‚îÇ
‚îÇ  - watchAppVersionProvider (Stream)    ‚îÇ
‚îÇ  - versionCheckerProvider              ‚îÇ
‚îÇ  - currentVersionInfoProvider          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚Üì                    ‚Üì                 ‚Üì
main.dart       VersionManagement   ForceUpdateScreen
              (–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

| –ú–æ–¥—É–ª—å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|--------|---------------|
| **auth** | –ü—Ä–æ–≤–µ—Ä–∫–∞ `profiles.role == 'admin'` —á–µ—Ä–µ–∑ RLS |
| **router** | –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/force-update` –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ |
| **notifications** | (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ |

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```yaml
dependencies:
  supabase_flutter: ^1.x          # Realtime Stream
  flutter_riverpod: ^2.x          # State management
  freezed_annotation: ^2.x        # Immutable models
  json_serializable: ^6.x         # JSON serialization
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚úÖ **RLS –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω** ‚Äî –Ω–µ–¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é  
‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏** ‚Äî —Ç–æ–ª—å–∫–æ `admin` –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å  
‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞** ‚Äî –Ω–∞ frontend (`^\d+\.\d+\.\d+$`)  
‚úÖ **Realtime –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî Supabase –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ events

---

## –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π —Å Realtime —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–µ–π
- ‚úÖ –≠–∫—Ä–∞–Ω –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º (iOS, Android, Web)
- ‚úÖ RLS –∑–∞—â–∏—Ç–∞ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å)
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

### üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π

- üü° –ë–æ–ª–µ–µ –≥—Ä–∞–Ω–¥–∏–æ–∑–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–µ—Ä—Å–∏–π (e.g. –æ—Ç–¥–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–ª—è iOS/Android)
- üü° –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–µ—Ä—Å–∏–π (log —Ç–∞–±–ª–∏—Ü–∞)
- üü° –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–π –≤—ã–ø—É—Å–∫ –≤–µ—Ä—Å–∏–∏ (schedule –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è)
- üü° A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π (gradual rollout)

### üü¢ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

- üü¢ Analytics –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π (—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–±–Ω–æ–≤–∏–ª–æ—Å—å)
- üü¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Web Dashboard –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- üü¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å store-–∞–≥–µ–Ω—Ç–∞–º–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø—É—Å–∫–∞

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ö–∞–∫ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é?

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ flutter_launcher –∑–∞–ø—É—Å–∫–µ
supabase migration up

# –ò–ª–∏ —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
supabase db push
```

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –≤ –ë–î?

```sql
SELECT current_version, minimum_version, force_update, updated_at 
FROM app_versions 
LIMIT 1;
```

### –ö–∞–∫ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–µ—Ä—Å–∏—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ?

–ò–∑–º–µ–Ω–∏—Ç–µ `AppConstants.appVersion` –≤ `lib/core/constants/app_constants.dart`:

```dart
static const String appVersion = '1.0.2';  // –ò–∑–º–µ–Ω–∏—Ç—å –∑–¥–µ—Å—å
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ —Å `pubspec.yaml`:

```yaml
version: 1.0.2+22  # X.Y.Z+buildNumber
```

### –ö–∞–∫ –≤—ã–∑–≤–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)?

```dart
// –í –ª—é–±–æ–º –º–µ—Å—Ç–µ –≤ –∫–æ–¥–µ
ref.read(routerProvider).go('/force-update');
```

### –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è?

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –¥–≤—É—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
2. –ù–∞ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑–º–µ–Ω–∏—Ç–µ `minimum_version`
3. –ù–∞ –æ–±–æ–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞ ~1 —Å–µ–∫

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π

```dart
final versionInfo = await ref.read(versionRepositoryProvider).getVersionInfo();
print('Current: ${versionInfo.currentVersion}');
print('Minimum: ${versionInfo.minimumVersion}');
print('Force update: ${versionInfo.forceUpdate}');
```

---

## –°—Ç–∞—Ç—É—Å –∏ Roadmap

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | ETA |
|--------|---------|-----|
| ‚úÖ MVP | –ë–∞–∑–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–µ—Ä—Å–∏–π | –≥–æ—Ç–æ–≤–æ |
| ‚úÖ Realtime | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö | –≥–æ—Ç–æ–≤–æ |
| ‚úÖ Admin UI | –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ | –≥–æ—Ç–æ–≤–æ |
| üü° Platform-specific | –û—Ç–¥–µ–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–ª—è iOS/Android | Q4 2025 |
| üü° Gradual Rollout | –í—ã–ø—É—Å–∫ –≤–µ—Ä—Å–∏–∏ –ø–æ—ç—Ç–∞–ø–Ω–æ (10% ‚Üí 50% ‚Üí 100%) | Q1 2026 |
| üü¢ Analytics Dashboard | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ WebApp | Q2 2026 |

---

## –ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ

```dart
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏
final isSupported = VersionUtils.isVersionSupported(
  AppConstants.appVersion,
  versionInfo.minimumVersion,
);

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
final versionAsync = ref.watch(watchAppVersionProvider);
final checker = ref.watch(versionCheckerProvider);
```

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

```dart
// –ù–µ –ø–∞—Ä—Å–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤—Ä—É—á–Ω—É—é
final currentVersion = int.parse(version);

// –ù–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏—é –ª–æ–∫–∞–ª—å–Ω–æ (–∏—Å–ø–æ–ª—å–∑—É–π Realtime)
// final version = await storage.getVersion();

// –ù–µ —á–∏—Ç–∞—Ç—å –≤–µ—Ä—Å–∏—é –±–µ–∑ Riverpod
// await supabase.from('app_versions').select();
```

---

**–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è:** 16 –æ–∫—Ç—è–±—Ä—è 2025 –≥–æ–¥–∞  
**–ê–≤—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** Senior Developer  
**–ö–æ–Ω—Ç–∞–∫—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤:** –ü–æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ dev-–∫–æ–º–∞–Ω–¥—É
